<!DOCTYPE html><html><head><title>JavaScript Performance For The Win</title><link href="/stylesheets/all-afdd94c3.css" media="screen" rel="stylesheet" type="text/css" /><script src="/javascripts/all-ce68a29a.js" type="text/javascript"></script><meta content='NO-CACHE' http-equiv='CACHE-CONTROL'><meta content='DockYard is a Ruby on Rails, PostgreSQL, and, Ember.js, web / mobile application development software consultancy based in Boston, MA.' namer='description'><meta content='ruby on rails, rails, ruby, ruby on rails training, ruby application development, ruby on rails application development, ember application development, ember.js application development, software application development, web, web application development, mobile, mobile application development, ios, ios application development, iphone, iphone application development, android, android application development, postgres, startups, enterprise, Boston, MA, Massachusetts, for hire' name='keywords'><meta content='web development, mobile development, startups, enterprise, ruby on rails, rails, ruby, ruby on rails training, Boston, for hire' name='keywords'><meta content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0' name='viewport'><meta charset='utf-8'><meta content='DockYard.com - ' name='description'><link href='//cloud.typography.com/6496052/702882/css/fonts.css' rel='stylesheet' type='text/css'><link href='http://dockyard.com/humans.txt' rel='author'><link href='/favicon-573a5e34.png' rel='shortcut icon' type='image/x-icon'><link href='/favicon-573a5e34.png' rel='icon' type='image/x-icon'><link href='/apple-touch-icon.png' rel='apple-touch-icon'><link href='/apple-touch-icon-precomposed.png' rel='apple-touch-icon-precomposed'><script>
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-24185112-2']);
    _gaq.push(['_trackPageview']);
  
    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
</script>
<!--
                                             ..
                                           .O.
                                       .:OO.
                                      :OOO.
                                    :OOO:.
                         ...      :OOOO:
                   ..ZOOOOOOOOO..OZ.O.
                   OOOOOOOOOOOOOOOOI
                  OOOOOOOOOOOOOOOOI,
                 OOOOOOOO. .OOOOOOOO:
                 OOOOOOOO   OOOOOOOOO:
                OOOOOOOOOOOOOOOOOOOOO.
                OOOOOOOOOOOOOOOOOOOOO:
               .OOOOOOOOOOOOOOOOOOOOO:
               .OOOOOOOOOOOOOOOOOOOOO.
                OOOOOOOOOOOOOOOOOOOOO
                OOOOOO?:   .OOOOOOOOO
               .OOOOO      OOOOOOOOOO
,OO ZO,        OOOOO,     OOOOOOOOOO+
 OOOOO.        OOOOO     OOOOOOOOOOO+
  OOO?        OOOOO     .OOOOOOOOOOO:
   OOO,      OOOOO.    .OOOOOOOOOOOO
    OOOOOOOOOOOOO.    .OOOOOOOOOOOO.
     OOOOOOOOOOOO.  .OOOOOOOOOOOOO.
      8OOOOOOOOOOOOOOOOOOOOOOOODO:
         :OOOOOOOOOOOOOOOOOOOO::

--></head><body class='x2014 x2014_09 x2014_09_22 x2014_09_22_javascript-performance-for-the-win'><header><div class='extended-nav-wrap'><div class='l-wrap--wide'><nav class='extended-nav'><a class="extended-nav--logo" data-icon="⌂" href="http://dockyard.com/"><span class='is-hidden'>Home</span></a>
<a class="extended-nav--close" data-icon="X" href="#"><span class='is-hidden'>Close</span></a><div class='extended-nav__items'><div class='extended-nav__items--mobile'><a class="extended-nav__item--work extended-nav__item" href="#">Work</a><nav class='work-nav--mobile'><a href="http://dockyard.com/work/credit-card-reviews" class="work-nav-item"><strong class='work-nav-item__title'>Credit Card Reviews</strong></a>
<a href="http://dockyard.com/work/coachup" class="work-nav-item"><strong class='work-nav-item__title'>CoachUp</strong></a>
<a href="http://dockyard.com/work/askthem" class="work-nav-item"><strong class='work-nav-item__title'>AskThem</strong></a>
<a href="http://dockyard.com/work/beacon-hill-blitz" class="work-nav-item"><strong class='work-nav-item__title'>Beacon Hill Blitz</strong></a></nav></div><a class="extended-nav__item" href="http://dockyard.com/team">Our Team</a><a class="extended-nav__item" href="http://dockyard.com/process">Process</a><a class="extended-nav__item" href="http://dockyard.com/community">Community</a><a class="extended-nav__item active" href="/">Blog</a><a class="extended-nav__item" href="http://dockyard.com/hire-us">Hire Us</a></div></nav><nav class='work-nav'><h6>Selected Work</h6><a href="http://dockyard.com/work/credit-card-reviews" class="work-nav-item"><strong class='work-nav-item__title'>Credit Card Reviews</strong><p>Credit card advice from real people.</p></a>
<a href="http://dockyard.com/work/coachup" class="work-nav-item"><strong class='work-nav-item__title'>CoachUp</strong><p>You should be training. Right now.</p></a>
<a href="http://dockyard.com/work/askthem" class="work-nav-item"><strong class='work-nav-item__title'>AskThem</strong><p>Ask officials questions on city, state, and federal levels.</p></a>
<a href="http://dockyard.com/work/beacon-hill-blitz" class="work-nav-item"><strong class='work-nav-item__title'>Beacon Hill Blitz</strong><p>How technology helped repeal the #TechTax.</p></a></nav></div></div><nav class='main-nav-wrap'><div class='main-nav l-wrap--wide'><a class="logo" href="http://dockyard.com">DockYard</a><a class="club-sandwich" data-icon="☰" href="#"><span class='is-hidden'>Navigation</span></a></div></nav></header><div class='push--header'></div><div class='l-wrap--blog'><a href="/"><strong class='logo--blog'>ReefPoints</strong><strong class='logo--blog__tagline'>Blog</strong></a><nav class='blog-nav'><a class="blog-nav__item " href="/">Posts</a><a class="blog-nav__item " href="/categories.html">Categories</a><a class="blog-nav__item " href="/authors.html">Authors</a></nav></div><div class='l-wrap--blog__post'><h1 class='post__title'>JavaScript Performance For The Win</h1><a class="post__author" href="/authors/alex-navasardyan.html">Alex Navasardyan</a><time class='post__date'>September 22<sup>nd</sup>, 2014</time><div class='post__content'><p>JavaScript performance is a very hot topic nowadays. There&#39;s a lot of information out there on what
browsers do with JavaScript code in order to execute it faster. Let&#39;s go over some of the tips that
will help you write faster JavaScript code.</p>

<h2>Tooling</h2>

<p>There&#39;re are couple of tools that you can use to identify and fix peformance problems. One of the
them is Chrome Developer Tools (open Chrome Developer Tools, switch to <code>Profiles</code> tab and click <code>Start</code>).
Developer Tools will give you a great overview of what actual happens in your application under the hood
(what functions are called, how much CPU time they consumed, how much memory). That&#39;s a great starting
point. Now you can start fixing performance where it matters.</p>

<h2>Non-optimizable code</h2>

<p><code>try-catch</code> and <code>try-finally</code> blocks will not be optimized by the V8 (to be clear, if the function contains
a <code>try</code> block, the whole function will not be optimized).</p>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
</pre></td>
  <td class="code"><pre><span class="comment">// code</span>
<span class="keyword">try</span> {
  iMightThrowFunc();
} <span class="keyword">catch</span>(exception) {
  iHandleExceptions(exception);
}
<span class="comment">// code</span>
</pre></td>
</tr></table>
</div></div>
<p>A better way of writing the code above, would be to isolate the <code>try</code> block into a separate function so <code>code</code>
can be optimized and only <code>iMightThrowFunc</code> would not be optimized:</p>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
<strong>10</strong>
11
</pre></td>
  <td class="code"><pre><span class="keyword">function</span> <span class="function">iMightThrow</span>() {
  <span class="keyword">try</span> {
    <span class="comment">// [code]</span>
  } <span class="keyword">catch</span>(exception) {
    iHandleExceptions(exception);
  }
}

<span class="comment">// code</span>
iMightThrow();
<span class="comment">// code</span>
</pre></td>
</tr></table>
</div></div>
<h2>Using Local Variables</h2>

<p>If you&#39;re using a piece of code many times, it&#39;s better to create a local variable for it for a couple of reasons:</p>

<ol>
<li>faster scope look ups (once the variable is local scope, it&#39;s faster to retrieve it)</li>
<li>caching (performing an operation once and storing the result will result in less work for the browser)</li>
</ol>

<h2>Literals</h2>

<p>It might sound very obvious but you should use object literals whenever you can.</p>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
</pre></td>
  <td class="code"><pre><span class="comment">// use</span>
<span class="keyword">var</span> array = [];
<span class="comment">// instead of</span>
<span class="keyword">var</span> array = <span class="keyword">new</span> Array(<span class="integer">16</span>);
</pre></td>
</tr></table>
</div></div>
<p>You rarely know what the size of the array is going to be in your application. Let V8 manage the growth
of the array as you add items to it. It will also ensure that the array is in &quot;fast elements&quot; mode and
item access is always fast. You can read more about V8 object representation <a href="http://jayconrod.com/posts/52/a-tour-of-v8-object-representation">here</a>.</p>

<h4>&quot;Dictionary Mode&quot;</h4>

<p>An object will go into &quot;dictionary mode&quot; when you add too many properties dynamically
(outside constructor), <code>delete</code> properties, use properties that cannot be valid identifiers.</p>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
</pre></td>
  <td class="code"><pre><span class="keyword">function</span> <span class="function">forInFunc</span>() {
  <span class="keyword">var</span> dictionary = {<span class="key"><span class="delimiter">'</span><span class="content">+</span><span class="delimiter">'</span></span>: <span class="integer">5</span>};
  <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> dictionary);
}
</pre></td>
</tr></table>
</div></div>
<p>When you use an object as if it was a dictionary, it will be turned into a dictionary (hash table).
Passing such an object to for-in is a no no.</p>

<h4>Iterating over a regular array</h4>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
</pre></td>
  <td class="code"><pre><span class="keyword">function</span> <span class="function">arrayFunc</span>() {
  <span class="keyword">var</span> arr = [<span class="integer">1</span>, <span class="integer">2</span>, <span class="integer">3</span>];
  <span class="keyword">for</span> (<span class="keyword">var</span> index <span class="keyword">in</span> arr) {

  }
}
</pre></td>
</tr></table>
</div></div>
<p>Iterating over an array using <code>for-in</code> is slower than a <code>for</code> loop and the entire function containing
a <code>for-in</code> statement will not be optimized.</p>

<p>Using <code>for</code> loop is almost always a safe bet. Do you need to iterate over object&#39;s properties?</p>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
<strong>10</strong>
11
12
13
</pre></td>
  <td class="code"><pre><span class="keyword">var</span> objKeys = Object.keys(obj);
<span class="keyword">var</span> propertyName;

<span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="integer">0</span>, l = objKeys.length; i &lt; l; i++) {
  propertyName = objKeys[i];
  <span class="comment">// more code</span>
}

<span class="keyword">for</span> (<span class="keyword">var</span> propertyName <span class="keyword">in</span> obj) {
  <span class="keyword">if</span> (obj.hasOwnProperty(propertyName)) {
    <span class="comment">// more code</span>
  }
}
</pre></td>
</tr></table>
</div></div>
<h2>For-In</h2>

<p><code>For-In</code> statements can prevent the entire function from being optimized in a few cases. It will result
in &quot;Not optimized: ForInStatement is not fast case&quot; bailout.</p>

<h3><code>key</code> has to be a pure local variable</h3>

<p>It cannot be from upper scope or referenced from lower scope.</p>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
</pre></td>
  <td class="code"><pre><span class="keyword">var</span> key;

<span class="keyword">function</span> <span class="function">doesNotSeemToBeLocalKey</span>() {
  <span class="keyword">var</span> obj = {};
  <span class="keyword">for</span> (key <span class="keyword">in</span> obj);
}
</pre></td>
</tr></table>
</div></div>
<h2>Arguments</h2>

<p>Careless manipulations with <code>arguments</code> might cause the whole function to be non-optimizable. It might result in
one of these &quot;bailouts&quot;: &quot;Not optimized: Bad value context for arguments value&quot; and &quot;Not optimized: assignment
to parameter in arguments object&quot;.</p>

<h3>Reassigning <code>arguments</code></h3>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
<strong>10</strong>
11
12
13
14
15
16
17
</pre></td>
  <td class="code"><pre><span class="comment">// do not re-assign arguments</span>
<span class="keyword">function</span> <span class="function">argumentsReassign</span>(foo, bar) {
  <span class="keyword">if</span> (foo &amp;&amp; foo === <span class="integer">5</span>) {
    bar = <span class="string"><span class="delimiter">'</span><span class="content">Barracudas</span><span class="delimiter">'</span></span>;
  }
  <span class="comment">// code that uses `bar`</span>
}

<span class="comment">// use local variables instead</span>
<span class="keyword">function</span> <span class="function">argumentsReassign</span>(foo, bar) {
  <span class="keyword">var</span> localBar;

  <span class="keyword">if</span> (foo &amp;&amp; foo === <span class="integer">5</span>) {
    localBar = <span class="string"><span class="delimiter">'</span><span class="content">Beantown Pub</span><span class="delimiter">'</span></span>;
  }
  <span class="comment">// code that uses `localBar`</span>
}
</pre></td>
</tr></table>
</div></div>
<h3>Leaking <code>arguments</code></h3>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
<strong>10</strong>
11
12
13
14
15
16
17
18
19
</pre></td>
  <td class="code"><pre><span class="comment">// `arguments` is a special object and it is costly to materialize.</span>
<span class="keyword">function</span> <span class="function">leaksArguments</span>() {
  <span class="keyword">var</span> args = [].slice.call(<span class="local-variable">arguments</span>);
  <span class="comment">// code that uses `args`</span>
}

<span class="comment">// does not leak arguments</span>
<span class="comment">// accessing `arguments.length` is just an integer and doesn't materialize</span>
<span class="comment">// `arguments` object</span>
<span class="keyword">function</span> <span class="function">doesNotLeakArguments</span>() {
  <span class="keyword">var</span> args = <span class="keyword">new</span> Array(<span class="local-variable">arguments</span>.length);

  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="integer">0</span>; i &lt; args.length; ++i) {
    <span class="comment">// `i` is always valid index in the arguments object</span>
    <span class="comment">// so we merely retrieve the value</span>
    args[i] = <span class="local-variable">arguments</span>[i];
  }
  <span class="comment">// code that uses `args`</span>
}
</pre></td>
</tr></table>
</div></div>
<p>Note, that in most cases optimizing takes more code. You can probably write a build step for that:</p>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
</pre></td>
  <td class="code"><pre><span class="keyword">function</span> <span class="function">doesNotLeakArguments</span>() {
  arguments_slice(args, <span class="local-variable">arguments</span>);
  <span class="comment">// code that uses `args`</span>
}
</pre></td>
</tr></table>
</div></div>
<p>Happy Coding!</p>
</div><div class='post__share'><a class='twitter-share-button' data-url='http://reefpoints.dockyard.com/2014/09/22/javascript-performance-for-the-win.html' data-via='DockYard' href='https://twitter.com/share'>Tweet</a><script>
  !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src='//platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document,'script','twitter-wjs');
</script><div class='g-plusone' data-href='#' data-size='medium' data-width='100'></div><script>
  (function() {var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;po.src = 'https://apis.google.com/js/plusone.js';var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);})();
</script><span class='post__share--github'>If you see an issue, please send a <a href='https://github.com/dockyard/reefpoints/blob/master/source/posts/', class='text-link post__issue', target: '_blank'>pull request</a> to contribute.</span></div><div class='related-posts-wrap'><div class='post__avatar-wrap'><img class='post__avatar' src='/images/team/alex-navasardyan.jpg'><h5 class='post__avatar__name'>Alex Navasardyan</h5><h5 class='post__avatar__position headline--sub'>Developer At DockYard
</h5><nav class='post__avatar__social-links'></nav></div><div class='related-posts'><h3 class='related-posts__header headline--sub'>Other posts by Alex</h3><a class="related-post" href="/2014/06/15/swift-and-javascript.html"><h2 class='related-post__title'>Swift and JavaScript</h2><p>June 15<sup>th</sup>, 2014</p></a>
<a class="related-post" href="/2014/04/17/ember-object-self-troll.html"><h2 class='related-post__title'>Ember Object Self Troll</h2><p>April 17<sup>th</sup>, 2014</p></a>
<a class="related-posts-link text-link" href="/authors/alex-navasardyan.html">See all 5 posts by Alex</a></div></div><p class='post__tags'><a class="post__tag" href="/categories/javascript.html">JavaScript&nbsp;<span class='post__tag__count'>(1)</span></a> <a class="post__tag" href="/categories/engineering.html">Engineering&nbsp;<span class='post__tag__count'>(3)</span></a></p><div id='disqus_thread'></div><script>
  var disqus_shortname = 'reefpoints';
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script><noscript>Please enable JavaScript to view the <a href='http://disqus.com/?ref_noscript'>comments powered by Disqus</a>.</noscript></noscript><script>
  var path = window.location.pathname.split('/').reverse();
  var postname = path[0].split('.');
  var change = postname[0] + '.md';
  var newpath = 'https://github.com/dockyard/reefpoints/blob/master/source/posts/' + path[3] + '-' + path[2] + '-' + path[1] + '-' + change
  $('.post__issue').attr('href', newpath);
</script></div><div class='push--footer'></div><footer><div class='l-wrap'><div class='l-footer-group'><h3 class='footer-group__title'>EVENTS</h3><a class="footer__event--wgc" target="_blank" href="http://wickedgoodember.com/">Wicked Good Ember Conf</a><a class="footer__event--ember" target="_blank" href="http://www.meetup.com/Boston-Ember-js/">Boston Ember.js Meetup</a><a class="footer__event--openhack" target="_blank" href="http://openhack.github.io/boston/">OpenHack Boston</a><a class="footer__event--ux" target="_blank" href="http://www.meetup.com/uxboston/">UX Boston Meetup</a><a class="footer__event--swift" target="_blank" href="http://www.meetup.com/Boston-Swift/">Boston Swift</a><a class="footer__event--uxhh" target="_blank" href="http://www.uxhappyhour.com/bos">UX Happy Hour</a></div><div class='l-footer-group'><a href="/"><h3 class='footer-group__title'>BLOG</h3></a>
<a class="footer__post" href="/2014/11/18/we-did-it.html"><strong>UX East Camp 2014</strong><h6 class='footer-desc'></h6></a>
<a class="footer__post" href="/2014/11/12/bring-to-ux-east.html"><strong>My project for UX Camp</strong><h6 class='footer-desc'></h6></a>
<a class="footer__post" href="/2014/11/07/pitch-this.html"><strong>Pitch This</strong><h6 class='footer-desc'></h6></a></div><div class='l-footer-group'><a href="http://dockyard.com/hire-us"><h3 class='footer-group__title'>CONTACT</h3></a><h6 class='footer-desc'>DockYard HQ is located in Boston. Stop in sometime and meet our team!</h6><a class="footer__address" target="_blank" href="http://goo.gl/maps/zBGfn"><h6>DockYard Inc.<br>101 Tremont Street<br>Suite 200<br>Boston, MA 02108</h6></a>
<a class="text-link" href="http://dockyard.com/hire-us">Get in touch.</a><div class='social-links--footer'><a target="_blank" data-icon="#" class="social-link" href="https://twitter.com/dockyard"><span class='is-hidden'>Twitter</span></a>
<a target="_blank" data-icon="★" class="social-link" href="https://github.com/dockyard"><span class='is-hidden'>GitHub</span></a>
<a target="_blank" data-icon="✒" class="social-link" href="http://reefpoints.dockyard.com/atom.xml"><span class='is-hidden'>RSS</span></a></div></div></div></footer><script>
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'reefpoints'; // required: replace example with your forum shortname
  
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function () {
      var s = document.createElement('script'); s.async = true;
      s.type = 'text/javascript';
      s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
      (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  }());
</script></body></html>
