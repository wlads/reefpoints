<!DOCTYPE html><html><head><title>Ember Object Self Troll</title><link href="/stylesheets/all-afdd94c3.css" media="screen" rel="stylesheet" type="text/css" /><script src="/javascripts/all-ce68a29a.js" type="text/javascript"></script><meta content='NO-CACHE' http-equiv='CACHE-CONTROL'><meta content='DockYard is a Ruby on Rails, PostgreSQL, and, Ember.js, web / mobile application development software consultancy based in Boston, MA.' namer='description'><meta content='ruby on rails, rails, ruby, ruby on rails training, ruby application development, ruby on rails application development, ember application development, ember.js application development, software application development, web, web application development, mobile, mobile application development, ios, ios application development, iphone, iphone application development, android, android application development, postgres, startups, enterprise, Boston, MA, Massachusetts, for hire' name='keywords'><meta content='web development, mobile development, startups, enterprise, ruby on rails, rails, ruby, ruby on rails training, Boston, for hire' name='keywords'><meta content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0' name='viewport'><meta charset='utf-8'><meta content='DockYard.com - Ember.Object.create explained' name='description'><meta content='twokul' name='twitter:creator'><meta content='summary' name='twitter:card'><meta content='@DockYard' name='twitter:site'><meta content='http://reefpoints.dockyard.com/2014/04/17/ember-object-self-troll.html' name='twitter:url'><meta content='Ember Object Self Troll' name='twitter:title'><meta content='Ember.Object.create explained' name='twitter:description'><link href='//cloud.typography.com/6496052/702882/css/fonts.css' rel='stylesheet' type='text/css'><link href='http://dockyard.com/humans.txt' rel='author'><link href='/favicon-573a5e34.png' rel='shortcut icon' type='image/x-icon'><link href='/favicon-573a5e34.png' rel='icon' type='image/x-icon'><link href='/apple-touch-icon.png' rel='apple-touch-icon'><link href='/apple-touch-icon-precomposed.png' rel='apple-touch-icon-precomposed'><script>
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-24185112-2']);
    _gaq.push(['_trackPageview']);
  
    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
</script>
<!--
                                             ..
                                           .O.
                                       .:OO.
                                      :OOO.
                                    :OOO:.
                         ...      :OOOO:
                   ..ZOOOOOOOOO..OZ.O.
                   OOOOOOOOOOOOOOOOI
                  OOOOOOOOOOOOOOOOI,
                 OOOOOOOO. .OOOOOOOO:
                 OOOOOOOO   OOOOOOOOO:
                OOOOOOOOOOOOOOOOOOOOO.
                OOOOOOOOOOOOOOOOOOOOO:
               .OOOOOOOOOOOOOOOOOOOOO:
               .OOOOOOOOOOOOOOOOOOOOO.
                OOOOOOOOOOOOOOOOOOOOO
                OOOOOO?:   .OOOOOOOOO
               .OOOOO      OOOOOOOOOO
,OO ZO,        OOOOO,     OOOOOOOOOO+
 OOOOO.        OOOOO     OOOOOOOOOOO+
  OOO?        OOOOO     .OOOOOOOOOOO:
   OOO,      OOOOO.    .OOOOOOOOOOOO
    OOOOOOOOOOOOO.    .OOOOOOOOOOOO.
     OOOOOOOOOOOO.  .OOOOOOOOOOOOO.
      8OOOOOOOOOOOOOOOOOOOOOOOODO:
         :OOOOOOOOOOOOOOOOOOOO::

--></head><body class='x2014 x2014_04 x2014_04_17 x2014_04_17_ember-object-self-troll'><header><div class='extended-nav-wrap'><div class='l-wrap--wide'><nav class='extended-nav'><a class="extended-nav--logo" data-icon="⌂" href="http://dockyard.com/"><span class='is-hidden'>Home</span></a>
<a class="extended-nav--close" data-icon="X" href="#"><span class='is-hidden'>Close</span></a><div class='extended-nav__items'><div class='extended-nav__items--mobile'><a class="extended-nav__item--work extended-nav__item" href="#">Work</a><nav class='work-nav--mobile'><a href="http://dockyard.com/work/credit-card-reviews" class="work-nav-item"><strong class='work-nav-item__title'>Credit Card Reviews</strong></a>
<a href="http://dockyard.com/work/coachup" class="work-nav-item"><strong class='work-nav-item__title'>CoachUp</strong></a>
<a href="http://dockyard.com/work/askthem" class="work-nav-item"><strong class='work-nav-item__title'>AskThem</strong></a>
<a href="http://dockyard.com/work/beacon-hill-blitz" class="work-nav-item"><strong class='work-nav-item__title'>Beacon Hill Blitz</strong></a></nav></div><a class="extended-nav__item" href="http://dockyard.com/team">Our Team</a><a class="extended-nav__item" href="http://dockyard.com/process">Process</a><a class="extended-nav__item" href="http://dockyard.com/community">Community</a><a class="extended-nav__item active" href="/">Blog</a><a class="extended-nav__item" href="http://dockyard.com/hire-us">Hire Us</a></div></nav><nav class='work-nav'><h6>Selected Work</h6><a href="http://dockyard.com/work/credit-card-reviews" class="work-nav-item"><strong class='work-nav-item__title'>Credit Card Reviews</strong><p>Credit card advice from real people.</p></a>
<a href="http://dockyard.com/work/coachup" class="work-nav-item"><strong class='work-nav-item__title'>CoachUp</strong><p>You should be training. Right now.</p></a>
<a href="http://dockyard.com/work/askthem" class="work-nav-item"><strong class='work-nav-item__title'>AskThem</strong><p>Ask officials questions on city, state, and federal levels.</p></a>
<a href="http://dockyard.com/work/beacon-hill-blitz" class="work-nav-item"><strong class='work-nav-item__title'>Beacon Hill Blitz</strong><p>How technology helped repeal the #TechTax.</p></a></nav></div></div><nav class='main-nav-wrap'><div class='main-nav l-wrap--wide'><a class="logo" href="http://dockyard.com">DockYard</a><a class="club-sandwich" data-icon="☰" href="#"><span class='is-hidden'>Navigation</span></a></div></nav></header><div class='push--header'></div><div class='l-wrap--blog'><a href="/"><strong class='logo--blog'>ReefPoints</strong><strong class='logo--blog__tagline'>Blog</strong></a><nav class='blog-nav'><a class="blog-nav__item " href="/">Posts</a><a class="blog-nav__item " href="/categories.html">Categories</a><a class="blog-nav__item " href="/authors.html">Authors</a></nav></div><div class='l-wrap--blog__post'><h1 class='post__title'>Ember Object Self Troll</h1><a class="post__author" href="/authors/alex-navasardyan.html">Alex Navasardyan</a><time class='post__date'>April 17<sup>th</sup>, 2014</time><div class='post__content'><p>Let&#39;s say we have a <code>Month</code> object. A <code>Month</code> has <code>weeks</code>.</p>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
</pre></td>
  <td class="code"><pre><span class="keyword">var</span> Month = Ember.Object.extend({
  <span class="key">weeks</span>: Em.A()
});
</pre></td>
</tr></table>
</div></div>
<p>Consider the following code:</p>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
<strong>10</strong>
11
</pre></td>
  <td class="code"><pre><span class="keyword">var</span> a = Month.create();
<span class="keyword">var</span> b = Month.create();

console.log(<span class="string"><span class="delimiter">'</span><span class="content">before a</span><span class="delimiter">'</span></span>, a.get(<span class="string"><span class="delimiter">'</span><span class="content">weeks</span><span class="delimiter">'</span></span>)); <span class="comment">// =&gt; []</span>
console.log(<span class="string"><span class="delimiter">'</span><span class="content">before b</span><span class="delimiter">'</span></span>, b.get(<span class="string"><span class="delimiter">'</span><span class="content">weeks</span><span class="delimiter">'</span></span>)); <span class="comment">// =&gt; []</span>

a.get(<span class="string"><span class="delimiter">'</span><span class="content">weeks</span><span class="delimiter">'</span></span>).pushObject(<span class="integer">1</span>);
a.get(<span class="string"><span class="delimiter">'</span><span class="content">weeks</span><span class="delimiter">'</span></span>).pushObject(<span class="integer">2</span>);

console.log(<span class="string"><span class="delimiter">'</span><span class="content">after a</span><span class="delimiter">'</span></span>, a.get(<span class="string"><span class="delimiter">'</span><span class="content">weeks</span><span class="delimiter">'</span></span>)); <span class="comment">// =&gt; [1, 2], as you expect</span>
console.log(<span class="string"><span class="delimiter">'</span><span class="content">after b</span><span class="delimiter">'</span></span>, b.get(<span class="string"><span class="delimiter">'</span><span class="content">weeks</span><span class="delimiter">'</span></span>)); <span class="comment">// =&gt; [1, 2], and you're like O_o</span>
</pre></td>
</tr></table>
</div></div>
<p>And another one:</p>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
</pre></td>
  <td class="code"><pre><span class="keyword">var</span> Month = Ember.Object.extend({
  <span class="key">weeks</span>: Em.A()
});

<span class="keyword">var</span> a = Month.create({ <span class="key">weeks</span>: Em.A([<span class="integer">1</span>, <span class="integer">2</span>]) });
<span class="keyword">var</span> b = Month.create();

console.log(<span class="string"><span class="delimiter">'</span><span class="content">a</span><span class="delimiter">'</span></span>, a.get(<span class="string"><span class="delimiter">'</span><span class="content">weeks</span><span class="delimiter">'</span></span>)); <span class="comment">// =&gt; [1, 2]</span>
console.log(<span class="string"><span class="delimiter">'</span><span class="content">b</span><span class="delimiter">'</span></span>, b.get(<span class="string"><span class="delimiter">'</span><span class="content">weeks</span><span class="delimiter">'</span></span>)); <span class="comment">// =&gt; []</span>
</pre></td>
</tr></table>
</div></div>
<p>The results of the first example are quite surprising, if you are not used
to the prototypical inheritance.</p>

<p>So what&#39;s going on there? Let&#39;s take a look at the &quot;very scary&quot; Ember.js <code>create</code> <a href="https://github.com/emberjs/ember.js/blob/master/packages_es6/ember-metal/lib/platform.js#L39-L52">function</a>:</p>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
<strong>10</strong>
11
12
13
14
</pre></td>
  <td class="code"><pre><span class="function">create</span> = <span class="keyword">function</span>(obj, props) {
  K.prototype = obj;
  obj = <span class="keyword">new</span> K();
  <span class="keyword">if</span> (props) {
    K.prototype = obj;
    <span class="keyword">for</span> (<span class="keyword">var</span> prop <span class="keyword">in</span> props) {
      K.prototype[prop] = props[prop].value;
    }
    obj = <span class="keyword">new</span> K();
  }
  K.prototype = <span class="predefined-constant">null</span>;

  <span class="keyword">return</span> obj;
};
</pre></td>
</tr></table>
</div></div>
<p>When you don&#39;t pass any properties to create (<code>props</code>), all instances of
the <code>Object</code> will share the same prototype. That&#39;s pretty much the gist
of the prototypical inheritance. It means that any changes on one object will
reflect on the others. That explains the behaviour in the first example.</p>

<p>If you pass the properties (that ones that you specified at <code>extend</code> time) to <code>create</code>,
they are going to be replaced on the instance&#39;s prototype.</p>

<p>There are two ways of changing the default behavior:</p>

<ul>
<li>turn <code>weeks</code> into a <a href="http://reefpoints.dockyard.com/2013/09/04/computed_properties_in_ember_js.html">Computed Property</a></li>
<li>set <code>weeks</code> on <code>init</code></li>
</ul>

<p>Using computed property:</p>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
</pre></td>
  <td class="code"><pre><span class="keyword">var</span> Month = Ember.Object.extend({
  <span class="key">weeks</span>: Ember.computed(<span class="keyword">function</span>() {
    <span class="keyword">return</span> Em.A();
  })
});
</pre></td>
</tr></table>
</div></div>
<p>In this case, <code>weeks</code> is going to return a new <code>Ember.Array</code> on <code>get</code>.
The code will run as you expect, <code>weeks</code> are not going to be shared.</p>

<p>Using <code>init</code>:</p>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
</pre></td>
  <td class="code"><pre><span class="keyword">var</span> Month = Ember.Object.extend({
  <span class="key">weeks</span>: <span class="predefined-constant">null</span>,

  <span class="function">init</span>: <span class="keyword">function</span>() {
    <span class="local-variable">this</span>._super();
    <span class="local-variable">this</span>.set(<span class="string"><span class="delimiter">'</span><span class="content">weeks</span><span class="delimiter">'</span></span>, Em.A());
  }
});
</pre></td>
</tr></table>
</div></div>
<p>This is very clear and nice technique if you&#39;re not familiar with computed properties.
Overriding <code>init</code> and calling <code>super</code> allows to run code upon the object&#39;s creation.
You can set the value for <code>weeks</code> there.</p>

<p>You can also use <code>on(&#39;init&#39;)</code> but it&#39;s discouraged because a subclass can provide
its own implementation of <code>setWeeks</code>:</p>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
</pre></td>
  <td class="code"><pre><span class="keyword">var</span> Month = Ember.Object.extend({
  <span class="function">setWeeks</span>: <span class="keyword">function</span>() {
    <span class="local-variable">this</span>.set(<span class="string"><span class="delimiter">'</span><span class="content">weeks</span><span class="delimiter">'</span></span>, Em.A());
  }.on(<span class="string"><span class="delimiter">'</span><span class="content">init</span><span class="delimiter">'</span></span>)
});
</pre></td>
</tr></table>
</div></div>
<p>Happy coding!</p>
</div><div class='post__share'><a class='twitter-share-button' data-url='http://reefpoints.dockyard.com/2014/04/17/ember-object-self-troll.html' data-via='DockYard' href='https://twitter.com/share'>Tweet</a><script>
  !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src='//platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document,'script','twitter-wjs');
</script><div class='g-plusone' data-href='#' data-size='medium' data-width='100'></div><script>
  (function() {var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;po.src = 'https://apis.google.com/js/plusone.js';var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);})();
</script><span class='post__share--github'>If you see an issue, please send a <a href='https://github.com/dockyard/reefpoints/blob/master/source/posts/', class='text-link post__issue', target: '_blank'>pull request</a> to contribute.</span></div><div class='related-posts-wrap'><div class='post__avatar-wrap'><img class='post__avatar' src='/images/team/alex-navasardyan.jpg'><h5 class='post__avatar__name'>Alex Navasardyan</h5><h5 class='post__avatar__position headline--sub'>Developer At DockYard
</h5><nav class='post__avatar__social-links'><a target="_blank" class="post__avatar__social-link--twitter" data-icon="#" href="http://twitter.com/twokul">twokul</a><a target="_blank" class="post__avatar__social-link--github" data-icon="★" href="https://github.com/twokul">twokul</a></nav></div><div class='related-posts'><h3 class='related-posts__header headline--sub'>Other posts by Alex</h3><a class="related-post" href="/2014/09/22/javascript-performance-for-the-win.html"><h2 class='related-post__title'>JavaScript Performance For The Win</h2><p>September 22<sup>nd</sup>, 2014</p></a>
<a class="related-post" href="/2014/06/15/swift-and-javascript.html"><h2 class='related-post__title'>Swift and JavaScript</h2><p>June 15<sup>th</sup>, 2014</p></a>
<a class="related-posts-link text-link" href="/authors/alex-navasardyan.html">See all 5 posts by Alex</a></div></div><p class='post__tags'><a class="post__tag" href="/categories/ember.html">Ember.js&nbsp;<span class='post__tag__count'>(27)</span></a></p><div id='disqus_thread'></div><script>
  var disqus_shortname = 'reefpoints';
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script><noscript>Please enable JavaScript to view the <a href='http://disqus.com/?ref_noscript'>comments powered by Disqus</a>.</noscript></noscript><script>
  var path = window.location.pathname.split('/').reverse();
  var postname = path[0].split('.');
  var change = postname[0] + '.md';
  var newpath = 'https://github.com/dockyard/reefpoints/blob/master/source/posts/' + path[3] + '-' + path[2] + '-' + path[1] + '-' + change
  $('.post__issue').attr('href', newpath);
</script></div><div class='push--footer'></div><footer><div class='l-wrap'><div class='l-footer-group'><h3 class='footer-group__title'>EVENTS</h3><a class="footer__event--wgc" target="_blank" href="http://wickedgoodember.com/">Wicked Good Ember Conf</a><a class="footer__event--ember" target="_blank" href="http://www.meetup.com/Boston-Ember-js/">Boston Ember.js Meetup</a><a class="footer__event--openhack" target="_blank" href="http://openhack.github.io/boston/">OpenHack Boston</a><a class="footer__event--ux" target="_blank" href="http://www.meetup.com/uxboston/">UX Boston Meetup</a><a class="footer__event--swift" target="_blank" href="http://www.meetup.com/Boston-Swift/">Boston Swift</a><a class="footer__event--uxhh" target="_blank" href="http://www.uxhappyhour.com/bos">UX Happy Hour</a></div><div class='l-footer-group'><a href="/"><h3 class='footer-group__title'>BLOG</h3></a>
<a class="footer__post" href="/2014/11/12/bring-to-ux-east.html"><strong>My project for UX Camp</strong><h6 class='footer-desc'></h6></a>
<a class="footer__post" href="/2014/11/07/pitch-this.html"><strong>Pitch This</strong><h6 class='footer-desc'></h6></a>
<a class="footer__post" href="/2014/10/30/motivation-vs-discipline.html"><strong>Motivation vs Discipline</strong><h6 class='footer-desc'></h6></a></div><div class='l-footer-group'><a href="http://dockyard.com/hire-us"><h3 class='footer-group__title'>CONTACT</h3></a><h6 class='footer-desc'>DockYard HQ is located in Boston. Stop in sometime and meet our team!</h6><a class="footer__address" target="_blank" href="http://goo.gl/maps/zBGfn"><h6>DockYard Inc.<br>101 Tremont Street<br>Suite 200<br>Boston, MA 02108</h6></a>
<a class="text-link" href="http://dockyard.com/hire-us">Get in touch.</a><div class='social-links--footer'><a target="_blank" data-icon="#" class="social-link" href="https://twitter.com/dockyard"><span class='is-hidden'>Twitter</span></a>
<a target="_blank" data-icon="★" class="social-link" href="https://github.com/dockyard"><span class='is-hidden'>GitHub</span></a>
<a target="_blank" data-icon="✒" class="social-link" href="http://reefpoints.dockyard.com/atom.xml"><span class='is-hidden'>RSS</span></a></div></div></div></footer><script>
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'reefpoints'; // required: replace example with your forum shortname
  
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function () {
      var s = document.createElement('script'); s.async = true;
      s.type = 'text/javascript';
      s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
      (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  }());
</script></body></html>
